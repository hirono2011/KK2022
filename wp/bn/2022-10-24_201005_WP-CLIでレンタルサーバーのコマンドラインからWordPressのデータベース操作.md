### WP-CLIでレンタルサーバーのコマンドラインからWordPressのデータベース操作　-　本件刑事告発・非常上告事件＼金沢地方検察庁御中

:CATEGORIES: @kanazawabengosi #金沢弁護士会 @JFBAsns 日本弁護士連合会（日弁連） #法務省 @MOJ_HOUMU #参考資料


　今日になって初めて知ったwp-cliというコマンドですが、レンタルサーバーにインストールしました。テーマやプラグインの管理もできるのですが、データベース操作が便利で簡単にバックアップが出来ます。

　開いていたページのタブを閉じていたようで、改めてwp-cliを検索したところ見つかったのが次のページですが、データベースのバックアップを圧縮保存する方法が書いてあって、205MBだったファイルが圧縮で53MBになっていました。

　投稿のテーブル名が「wp20221002092307_posts」になっていました。あまり覚えていなかったのですが10月2日の午前9時23分にWordPressを新規作成したようです。自動で作成される記事があるので、そのときにテーブルも出来ているはずです。

　「wp db export - | gzip -c > ./db_2022-10-13.sql.gz」というコマンドでデータベースのバックアップを作成しました。データベースの削除やバックアップファイルを使ったインポートも簡単にできるようです。

　WordPressのディレクトリーで「wp db cli」というコマンドを実行するとMySQLにログインした状態となり、そのままデータベースをuse状態でデータベースの操作が行えます。これまでもやってきたことですが、違いはフィールド名ぐらいかと思います。

　wp-cliでコマンドラインからWordPressに記事を投稿したり削除する方法も見かけているのですが、ログインした状態でデータベース操作をすると、特定条件の記事を非公開したり、文字列の全置換なども簡単にできそうです。

　さきほどのuseですが、レンタルサーバーだとMySQLにログインした状態でデータベースの切り替えは出来ないかもしれません。直接mysqlコマンドを使うとデータベースの指定など面倒があったことを思い出しました。

- WP-CLIで知っておくと便利な機能　-　Qiita[ _https://qiita.com/yousan/items/65349d1b20b3db28a554_](https://qiita.com/yousan/items/65349d1b20b3db28a554)

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> DESCRIBE  wp20221002092307_posts;
+-----------------------+---------------------+------+-----+---------------------+----------------+
| Field                 | Type                | Null | Key | Default             | Extra          |
+-----------------------+---------------------+------+-----+---------------------+----------------+
| ID                    | bigint(20) unsigned | NO   | PRI | NULL                | auto_increment |
| post_author           | bigint(20) unsigned | NO   | MUL | 0                   |                |
| post_date             | datetime            | NO   |     | 0000-00-00 00:00:00 |                |
| post_date_gmt         | datetime            | NO   |     | 0000-00-00 00:00:00 |                |
| post_content          | longtext            | NO   |     | NULL                |                |
| post_title            | text                | NO   |     | NULL                |                |
| post_excerpt          | text                | NO   |     | NULL                |                |
| post_status           | varchar(20)         | NO   |     | publish             |                |
| comment_status        | varchar(20)         | NO   |     | open                |                |
| ping_status           | varchar(20)         | NO   |     | open                |                |
| post_password         | varchar(255)        | NO   |     |                     |                |
| post_name             | varchar(200)        | NO   | MUL |                     |                |
| to_ping               | text                | NO   |     | NULL                |                |
| pinged                | text                | NO   |     | NULL                |                |
| post_modified         | datetime            | NO   |     | 0000-00-00 00:00:00 |                |
| post_modified_gmt     | datetime            | NO   |     | 0000-00-00 00:00:00 |                |
| post_content_filtered | longtext            | NO   |     | NULL                |                |
| post_parent           | bigint(20) unsigned | NO   | MUL | 0                   |                |
| guid                  | varchar(255)        | NO   |     |                     |                |
| menu_order            | int(11)             | NO   |     | 0                   |                |
| post_type             | varchar(20)         | NO   | MUL | post                |                |
| post_mime_type        | varchar(100)        | NO   |     |                     |                |
| comment_count         | bigint(20)          | NO   |     | 0                   |                |
+-----------------------+---------------------+------+-----+---------------------+----------------+
23 rows in set (0.01 sec)

mysql> 

Follow me!


# 関連記事



[レンタルサーバーのコマンドラインでのWordPressを操作するphpファイルの実行](http://hirono-hideki.info/kk2022/2022-10-14_617)

 __2022-10-14_111432



[WordPressの記事をテキストデータで取得するpythonスクリプト](http://hirono-hideki.info/kk2022/2022-10-05_138)

 __2022-10-05_060843



最終更新日時：2022-10-24_201005
